/**
 * Minified by jsDelivr using UglifyJS v3.3.22.
 * Original file: /npm/strophejs-plugin-muc@1.1.0/lib/strophe.muc.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("strophe.js")):"function"==typeof define&&define.amd?define(["strophe.js"],e):e(t.window)}(this,function(l){"use strict";var n,d,c={}.hasOwnProperty,o=function(t,e){return function(){return t.apply(e,arguments)}};l.Strophe.addConnectionPlugin("muc",{_connection:null,rooms:{},roomNames:[],init:function(t){return this._connection=t,this._muc_handler=null,l.Strophe.addNamespace("MUC_OWNER",l.Strophe.NS.MUC+"#owner"),l.Strophe.addNamespace("MUC_ADMIN",l.Strophe.NS.MUC+"#admin"),l.Strophe.addNamespace("MUC_USER",l.Strophe.NS.MUC+"#user"),l.Strophe.addNamespace("MUC_ROOMCONF",l.Strophe.NS.MUC+"#roomconfig"),l.Strophe.addNamespace("MUC_REGISTER","jabber:iq:register")},join:function(u,t,e,n,i,o,r,s){var c,h,a;return h=this.test_append_nick(u,t),c=l.$pres({from:this._connection.jid,to:h}).c("x",{xmlns:l.Strophe.NS.MUC}),null!=r&&(c=c.c("history",r).up()),null!=o&&c.cnode(l.Strophe.xmlElement("password",[],o)),null!=s&&c.up().cnode(s),null==this._muc_handler&&(this._muc_handler=this._connection.addHandler((a=this,function(t){var e,n,i,o,r,s,c,h;if(!(e=t.getAttribute("from")))return!0;if(s=e.split("/")[0],!a.rooms[s])return!0;if(u=a.rooms[s],n={},"message"===t.nodeName)n=u._message_handlers;else if("presence"===t.nodeName&&0<(h=t.getElementsByTagName("x")).length)for(i=0,r=h.length;i<r;i++)if((c=h[i].getAttribute("xmlns"))&&c.match(l.Strophe.NS.MUC)){n=u._presence_handlers;break}for(o in n)(0,n[o])(t,u)||delete n[o];return!0}))),this.rooms.hasOwnProperty(u)||(this.rooms[u]=new d(this,u,t,o),n&&this.rooms[u].addHandler("presence",n),e&&this.rooms[u].addHandler("message",e),i&&this.rooms[u].addHandler("roster",i),this.roomNames.push(u)),this._connection.send(c)},leave:function(t,e,n,i){var o,r,s,c;return o=this.roomNames.indexOf(t),delete this.rooms[t],0<=o&&(this.roomNames.splice(o,1),0===this.roomNames.length&&(this._connection.deleteHandler(this._muc_handler),this._muc_handler=null)),c=this.test_append_nick(t,e),s=this._connection.getUniqueId(),r=l.$pres({type:"unavailable",id:s,from:this._connection.jid,to:c}),null!=i&&r.c("status",i),null!=n&&this._connection.addHandler(n,null,"presence",null,s),this._connection.send(r),s},message:function(t,e,n,i,o,r){var s,c,h;return h=this.test_append_nick(t,e),o=o||(null!=e?"chat":"groupchat"),r=r||this._connection.getUniqueId(),(s=l.$msg({to:h,from:this._connection.jid,type:o,id:r}).c("body").t(n)).up(),null!=i&&(s.c("html",{xmlns:l.Strophe.NS.XHTML_IM}).c("body",{xmlns:l.Strophe.NS.XHTML}).h(i),0===s.node.childNodes.length?(c=s.node.parentNode,s.up().up(),s.node.removeChild(c)):s.up().up()),s.c("x",{xmlns:"jabber:x:event"}).c("composing"),this._connection.send(s),r},groupchat:function(t,e,n,i){return this.message(t,null,e,n,void 0,i)},invite:function(t,e,n){var i,o;return o=this._connection.getUniqueId(),i=l.$msg({from:this._connection.jid,to:t,id:o}).c("x",{xmlns:l.Strophe.NS.MUC_USER}).c("invite",{to:e}),null!=n&&i.c("reason",n),this._connection.send(i),o},multipleInvites:function(t,e,n){var i,o,r,s,c;for(s=this._connection.getUniqueId(),o=l.$msg({from:this._connection.jid,to:t,id:s}).c("x",{xmlns:l.Strophe.NS.MUC_USER}),i=0,r=e.length;i<r;i++)c=e[i],o.c("invite",{to:c}),null!=n&&(o.c("reason",n),o.up()),o.up();return this._connection.send(o),s},directInvite:function(t,e,n,i){var o,r,s;return s=this._connection.getUniqueId(),o={xmlns:"jabber:x:conference",jid:t},null!=n&&(o.reason=n),null!=i&&(o.password=i),r=l.$msg({from:this._connection.jid,to:e,id:s}).c("x",o),this._connection.send(r),s},queryOccupants:function(t,e,n){var i,o;return i={xmlns:l.Strophe.NS.DISCO_ITEMS},o=l.$iq({from:this._connection.jid,to:t,type:"get"}).c("query",i),this._connection.sendIQ(o,e,n)},configure:function(t,e,n){var i;return i=l.$iq({to:t,type:"get"}).c("query",{xmlns:l.Strophe.NS.MUC_OWNER}).tree(),this._connection.sendIQ(i,e,n)},cancelConfigure:function(t){var e;return e=l.$iq({to:t,type:"set"}).c("query",{xmlns:l.Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"cancel"}).tree(),this._connection.sendIQ(e)},saveConfiguration:function(t,e,n,i){var o,r,s,c,h;if(s=l.$iq({to:t,type:"set"}).c("query",{xmlns:l.Strophe.NS.MUC_OWNER}),void 0!==l.Strophe.x&&void 0!==l.Strophe.x.Form&&e instanceof l.Strophe.x.Form)e.type="submit",s.cnode(e.toXML());else for(s.c("x",{xmlns:"jabber:x:data",type:"submit"}),r=0,c=e.length;r<c;r++)o=e[r],s.cnode(o).up();return h=s.tree(),this._connection.sendIQ(h,n,i)},createInstantRoom:function(t,e,n){var i;return i=l.$iq({to:t,type:"set"}).c("query",{xmlns:l.Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"}),this._connection.sendIQ(i.tree(),e,n)},createConfiguredRoom:function(t,e,n,i){var o,r,s;for(o in(r=l.$iq({to:t,type:"set"}).c("query",{xmlns:l.Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"})).c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up(),e)c.call(e,o)&&(s=e[o],r.c("field",{var:o}).c("value").t(s).up().up());return this._connection.sendIQ(r.tree(),n,i)},setTopic:function(t,e){var n;return n=l.$msg({to:t,from:this._connection.jid,type:"groupchat"}).c("subject",{xmlns:"jabber:client"}).t(e),this._connection.send(n.tree())},_modifyPrivilege:function(t,e,n,i,o){var r;return r=l.$iq({to:t,type:"set"}).c("query",{xmlns:l.Strophe.NS.MUC_ADMIN}).cnode(e.node),null!=n&&r.c("reason",n),this._connection.sendIQ(r.tree(),i,o)},modifyRole:function(t,e,n,i,o,r){var s;return s=l.$build("item",{nick:e,role:n}),this._modifyPrivilege(t,s,i,o,r)},kick:function(t,e,n,i,o){return this.modifyRole(t,e,"none",n,i,o)},voice:function(t,e,n,i,o){return this.modifyRole(t,e,"participant",n,i,o)},mute:function(t,e,n,i,o){return this.modifyRole(t,e,"visitor",n,i,o)},op:function(t,e,n,i,o){return this.modifyRole(t,e,"moderator",n,i,o)},deop:function(t,e,n,i,o){return this.modifyRole(t,e,"participant",n,i,o)},modifyAffiliation:function(t,e,n,i,o,r){var s;return s=l.$build("item",{jid:e,affiliation:n}),this._modifyPrivilege(t,s,i,o,r)},ban:function(t,e,n,i,o){return this.modifyAffiliation(t,e,"outcast",n,i,o)},member:function(t,e,n,i,o){return this.modifyAffiliation(t,e,"member",n,i,o)},revoke:function(t,e,n,i,o){return this.modifyAffiliation(t,e,"none",n,i,o)},owner:function(t,e,n,i,o){return this.modifyAffiliation(t,e,"owner",n,i,o)},admin:function(t,e,n,i,o){return this.modifyAffiliation(t,e,"admin",n,i,o)},changeNick:function(t,e){var n,i;return i=this.test_append_nick(t,e),n=l.$pres({from:this._connection.jid,to:i,id:this._connection.getUniqueId()}),this._connection.send(n.tree())},setStatus:function(t,e,n,i){var o,r;return r=this.test_append_nick(t,e),o=l.$pres({from:this._connection.jid,to:r}),null!=n&&o.c("show",n).up(),null!=i&&o.c("status",i),this._connection.send(o.tree())},registrationRequest:function(t,c,e){var n;return n=l.$iq({to:t,from:this._connection.jid,type:"get"}).c("query",{xmlns:l.Strophe.NS.MUC_REGISTER}),this._connection.sendIQ(n,function(t){var e,n,i,o,r,s;for((n=t.getElementsByTagName("field")).length,o={required:[],optional:[]},r=0,s=n.length;r<s;r++)i={var:(e=n[r]).getAttribute("var"),label:e.getAttribute("label"),type:e.getAttribute("type")},0<e.getElementsByTagName("required").length?o.required.push(i):o.optional.push(i);return c(o)},e)},submitRegistrationForm:function(t,e,n,i){var o,r,s;for(r in(o=l.$iq({to:t,type:"set"}).c("query",{xmlns:l.Strophe.NS.MUC_REGISTER})).c("x",{xmlns:"jabber:x:data",type:"submit"}),o.c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#register").up().up(),e)s=e[r],o.c("field",{var:r}).c("value").t(s).up().up();return this._connection.sendIQ(o,n,i)},listRooms:function(t,e,n){var i;return i=l.$iq({to:t,from:this._connection.jid,type:"get"}).c("query",{xmlns:l.Strophe.NS.DISCO_ITEMS}),this._connection.sendIQ(i,e,n)},test_append_nick:function(t,e){return l.Strophe.escapeNode(l.Strophe.getNodeFromJid(t))+"@"+l.Strophe.getDomainFromJid(t)+(null!=e?"/"+e:"")}}),d=function(){function s(t,e,n,i){this.client=t,this.name=e,this.nick=n,this.password=i,this._roomRosterHandler=o(this._roomRosterHandler,this),this._addOccupant=o(this._addOccupant,this),this.roster={},this._message_handlers={},this._presence_handlers={},this._roster_handlers={},this._handler_ids=0,this.client.muc&&(this.client=this.client.muc),this.name=l.Strophe.getBareJidFromJid(this.name),this.addHandler("presence",this._roomRosterHandler)}return s.prototype.join=function(t,e,n){return this.client.join(this.name,this.nick,t,e,n,this.password)},s.prototype.leave=function(t,e){return this.client.leave(this.name,this.nick,t,e),delete this.client.rooms[this.name]},s.prototype.message=function(t,e,n,i){return this.client.message(this.name,t,e,n,i)},s.prototype.groupchat=function(t,e){return this.client.groupchat(this.name,t,e)},s.prototype.invite=function(t,e){return this.client.invite(this.name,t,e)},s.prototype.multipleInvites=function(t,e){return this.client.invite(this.name,t,e)},s.prototype.directInvite=function(t,e){return this.client.directInvite(this.name,t,e,this.password)},s.prototype.configure=function(t){return this.client.configure(this.name,t)},s.prototype.cancelConfigure=function(){return this.client.cancelConfigure(this.name)},s.prototype.saveConfiguration=function(t){return this.client.saveConfiguration(this.name,t)},s.prototype.queryOccupants=function(t,e){return this.client.queryOccupants(this.name,t,e)},s.prototype.setTopic=function(t){return this.client.setTopic(this.name,t)},s.prototype.modifyRole=function(t,e,n,i,o){return this.client.modifyRole(this.name,t,e,n,i,o)},s.prototype.kick=function(t,e,n,i){return this.client.kick(this.name,t,e,n,i)},s.prototype.voice=function(t,e,n,i){return this.client.voice(this.name,t,e,n,i)},s.prototype.mute=function(t,e,n,i){return this.client.mute(this.name,t,e,n,i)},s.prototype.op=function(t,e,n,i){return this.client.op(this.name,t,e,n,i)},s.prototype.deop=function(t,e,n,i){return this.client.deop(this.name,t,e,n,i)},s.prototype.modifyAffiliation=function(t,e,n,i,o){return this.client.modifyAffiliation(this.name,t,e,n,i,o)},s.prototype.ban=function(t,e,n,i){return this.client.ban(this.name,t,e,n,i)},s.prototype.member=function(t,e,n,i){return this.client.member(this.name,t,e,n,i)},s.prototype.revoke=function(t,e,n,i){return this.client.revoke(this.name,t,e,n,i)},s.prototype.owner=function(t,e,n,i){return this.client.owner(this.name,t,e,n,i)},s.prototype.admin=function(t,e,n,i){return this.client.admin(this.name,t,e,n,i)},s.prototype.changeNick=function(t){return this.nick=t,this.client.changeNick(this.name,nick)},s.prototype.setStatus=function(t,e){return this.client.setStatus(this.name,this.nick,t,e)},s.prototype.addHandler=function(t,e){var n;switch(n=this._handler_ids++,t){case"presence":this._presence_handlers[n]=e;break;case"message":this._message_handlers[n]=e;break;case"roster":this._roster_handlers[n]=e;break;default:return this._handler_ids--,null}return n},s.prototype.removeHandler=function(t){return delete this._presence_handlers[t],delete this._message_handlers[t],delete this._roster_handlers[t]},s.prototype._addOccupant=function(t){var e;return e=new n(t,this),this.roster[e.nick]=e},s.prototype._roomRosterHandler=function(t){var e,n,i,o,r;switch(o=(e=s._parsePresence(t)).nick,i=e.newnick||null,e.type){case"error":return!0;case"unavailable":i&&(e.nick=i,this.roster[o]&&this.roster[i]&&(this.roster[o].update(this.roster[i]),this.roster[i]=this.roster[o]),this.roster[o]&&!this.roster[i]&&(this.roster[i]=this.roster[o].update(e))),delete this.roster[o];break;default:this.roster[o]?this.roster[o].update(e):this._addOccupant(e)}for(n in r=this._roster_handlers)(0,r[n])(this.roster,this)||delete this._roster_handlers[n];return!0},s._parsePresence=function(t){var e,n,i,o,r,s,c,h,u,a;for((i={}).nick=l.Strophe.getResourceFromJid(t.getAttribute("from")),i.type=t.getAttribute("type"),i.states=[],o=0,s=(h=t.childNodes).length;o<s;o++)switch((e=h[o]).nodeName){case"error":i.errorcode=e.getAttribute("code"),i.error=null!=(u=e.childNodes[0])?u.nodeName:void 0;break;case"status":i.status=e.textContent||null;break;case"show":i.show=e.textContent||null;break;case"x":if(e.getAttribute("xmlns")===l.Strophe.NS.MUC_USER)for(r=0,c=(a=e.childNodes).length;r<c;r++)switch((n=a[r]).nodeName){case"item":i.affiliation=n.getAttribute("affiliation"),i.role=n.getAttribute("role"),i.jid=n.getAttribute("jid"),i.newnick=n.getAttribute("nick");break;case"status":n.getAttribute("code")&&i.states.push(n.getAttribute("code"))}}return i},s}(),function(){function t(t){this.parse=o(this.parse,this),null!=t&&this.parse(t)}t.prototype.parse=function(t){var e,n,i,o,r,s,c,h,u,a,l,d,p;for(d=t.getElementsByTagName("query")[0].childNodes,this.identities=[],this.features=[],this.x=[],r=0,u=d.length;r<u;r++)switch(n=(i=d[r]).attributes,i.nodeName){case"identity":for(s={},c=0,a=n.length;c<a;c++)s[(e=n[c]).name]=e.textContent;this.identities.push(s);break;case"feature":this.features.push(i.getAttribute("var"));break;case"x":if("FORM_TYPE"===!i.childNodes[0].getAttribute("var")||"hidden"===!i.childNodes[0].getAttribute("type"))break;for(h=0,l=(p=i.childNodes).length;h<l;h++)(o=p[h]).attributes.type||this.x.push({var:o.getAttribute("var"),label:o.getAttribute("label")||"",value:o.firstChild.textContent||""})}return{identities:this.identities,features:this.features,x:this.x}}}(),n=function(){function t(t,e){this.room=e,this.update=o(this.update,this),this.admin=o(this.admin,this),this.owner=o(this.owner,this),this.revoke=o(this.revoke,this),this.member=o(this.member,this),this.ban=o(this.ban,this),this.modifyAffiliation=o(this.modifyAffiliation,this),this.deop=o(this.deop,this),this.op=o(this.op,this),this.mute=o(this.mute,this),this.voice=o(this.voice,this),this.kick=o(this.kick,this),this.modifyRole=o(this.modifyRole,this),this.update(t)}return t.prototype.modifyRole=function(t,e,n,i){return this.room.modifyRole(this.nick,t,e,n,i)},t.prototype.kick=function(t,e,n){return this.room.kick(this.nick,t,e,n)},t.prototype.voice=function(t,e,n){return this.room.voice(this.nick,t,e,n)},t.prototype.mute=function(t,e,n){return this.room.mute(this.nick,t,e,n)},t.prototype.op=function(t,e,n){return this.room.op(this.nick,t,e,n)},t.prototype.deop=function(t,e,n){return this.room.deop(this.nick,t,e,n)},t.prototype.modifyAffiliation=function(t,e,n,i){return this.room.modifyAffiliation(this.jid,t,e,n,i)},t.prototype.ban=function(t,e,n){return this.room.ban(this.jid,t,e,n)},t.prototype.member=function(t,e,n){return this.room.member(this.jid,t,e,n)},t.prototype.revoke=function(t,e,n){return this.room.revoke(this.jid,t,e,n)},t.prototype.owner=function(t,e,n){return this.room.owner(this.jid,t,e,n)},t.prototype.admin=function(t,e,n){return this.room.admin(this.jid,t,e,n)},t.prototype.update=function(t){return this.nick=t.nick||null,this.affiliation=t.affiliation||null,this.role=t.role||null,this.jid=t.jid||null,this.status=t.status||null,this.show=t.show||null,this},t}()});
//# sourceMappingURL=/sm/363834f72f8830891ded0e2371fb97b773099f4623362586564fdc5db32da561.map